server {
    listen 8084 default_server;
    listen [::]:8084 default_server;
    
    server_name _ 10.0.0.2 localhost;
    root /app/output;
    index index.html;
    
    # Enable gzip compression
    gzip on;
    gzip_types text/plain text/css application/json application/javascript text/xml application/xml application/xml+rss text/javascript;
    
    # CORS headers for all responses
    add_header Access-Control-Allow-Origin * always;
    add_header Access-Control-Allow-Methods "GET, HEAD, OPTIONS" always;
    add_header Access-Control-Allow-Headers "Range, Content-Range" always;
    
    # Video file handling with proper MIME types and range support
    location ~* \.(mp4|mkv|avi|mov|webm|m4v|flv|wmv)$ {
        add_header Cache-Control "public, max-age=31536000" always;
        add_header Accept-Ranges bytes always;
        
        # Enable efficient serving of large files
        sendfile on;
        tcp_nopush on;
    }
    
    # Directory listing with autoindex
    location / {
        autoindex on;
        autoindex_exact_size off;
        autoindex_localtime on;
        try_files $uri $uri/ =404;
    }
    
    # Handle favicon requests
    location = /favicon.ico {
        log_not_found off;
        access_log off;
        return 204;
    }
    
    # Client settings for large video files
    client_max_body_size 2G;
    
    # Basic security
    server_tokens off;
}